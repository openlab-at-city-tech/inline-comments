"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}(function(incom,$){"use strict";var o;var _wp$i18n=wp.i18n,sprintf=_wp$i18n.sprintf,__=_wp$i18n.__;var idWrapper="incom_wrapper",idWrapperHash="#"+idWrapper,idWrapperAppendTo="html",idCommentsAndForm="comments-and-form",idCommentsAndFormHash="#"+idCommentsAndForm,idCommentForm="incom-commentform",attDataIncom="data-incom",attDataIncomComment=attDataIncom+"-comment",attDataIncomBubble=attDataIncom+"-bubble",attDataIncomRef=attDataIncom+"-ref",classActive="incom-active",classActiveDot="."+classActive,classVisibleComment="incom-visible-comment",classVisibleCommentDot="."+classVisibleComment,classPosition="incom-position-",classBubble="incom-bubble",classBubbleDot="."+classBubble,classBubbleStyle=classBubble+"-style",classBubbleStatic=classBubble+"-static",classBubbleStaticDot="."+classBubbleStatic,classBubbleDynamic=classBubble+"-dynamic",classBubbleActive=classBubble+"-active",classBubbleLink=classBubble+"-link",classCommentsWrapper="incom-comments-wrapper",classCommentsWrapperDot="."+classCommentsWrapper,classReply="incom-reply",classReplyDot="."+classReply,classCancel="incom-cancel",classCancelDot="."+classCancel,classBranding="incom-info-icon",classBrandingDot="."+classBranding,classScrolledTo="incom-scrolled-to",dataIncomKey="data_incom",attDataIncomArr=[];var slideWidth=0,lastFocusedBubble=null,$viewportW=$(window).width(),$elementW,$offsetL,$sumOffsetAndElementW;incom.rebuild=function(){$viewportW=$(window).width();while(attDataIncomArr.length>0){attDataIncomArr.pop()}$("#incom_wrapper .incom-bubble").remove();initElementsAndBubblesFromSelectors();var commentsForm=$(idCommentsAndFormHash+":visible");if(commentsForm.length){removeCommentsWrapper();moveSite("out")}};var setOptions=function setOptions(options){o=$.extend({canComment:true,selectors:"p",moveSiteSelector:idWrapperAppendTo,countStatic:true,alwaysStatic:false,defaultBubbleText:"+",bubbleStyle:"bubble",bubbleAnimationIn:"default",bubbleAnimationOut:"default",position:"left",background:"white",backgroundOpacity:"1",displayBranding:false},options)};var initIncomWrapper=function initIncomWrapper(){var docFragment,wrapper,wrapperParent;if($(idWrapperHash).length===0){docFragment=document.createDocumentFragment();wrapper=document.createElement("div");wrapperParent=document.querySelector(idWrapperAppendTo);wrapper.setAttribute("id",idWrapper);wrapper.className=classPosition+o.position;docFragment.appendChild(wrapper);wrapperParent.appendChild(docFragment)}initElementsAndBubblesFromSelectors()};var initElementsAndBubblesFromSelectors=function initElementsAndBubblesFromSelectors(){var $contentArea=findContentArea();var elementsBySelectors=$contentArea.find(o.selectors);var l=elementsBySelectors.length;for(var j=0;j<l;j++){var $that=$(elementsBySelectors[j]);addAttToElement($that);bubble.createFromElement($that)}};var findContentArea=function findContentArea(){var $content=$(".entry-content");if($content.length){return $content}var $main=$("main");if($main.length&&1===$main.length){return $main}var $lingonberryContent=$(".content.section-inner .post-content");if($lingonberryContent.length){return $lingonberryContent}return $("body")};var addAttToElement=function addAttToElement($element){var i=0;var elementDataIncomAttr=$element.data("incom");if(elementDataIncomAttr){return}var identifier=getIdentifier($element);i=increaseIdentifierNumberIfAttPropExists(i,identifier);var attProp=identifier+i;$element.attr(attDataIncom,attProp);$element.attr("id","incom-element-"+attProp)};var bubble={createFromElement:function createFromElement($element){addBubble($element)}};var getIdentifier=function getIdentifier(element){var identifier=element.prop("tagName").substr(0,5);return identifier};var increaseIdentifierNumberIfAttPropExists=function increaseIdentifierNumberIfAttPropExists(i,identifier){var attProp=identifier+i;if($.inArray(attProp,attDataIncomArr)!==-1){while($.inArray(attProp,attDataIncomArr)!==-1){i++;attProp=identifier+i}}attDataIncomArr.push(attProp);return i};var addBubble=function addBubble(source){var bubbleText=addBubbleText(source);var bubbleContainer=loadBubbleContainer(source);var $bubble=$("<a/>",{href:"",class:classBubbleLink}).text(bubbleText).wrap(bubbleContainer).parent().appendTo(idWrapperHash);setDisplayStatic($bubble);setBubblePosition(source,$bubble);if(!isInWindow($bubble)){$bubble.hide()}else{handleHover(source,$bubble);$bubble.on("click",function(e){e.preventDefault();var isKeyboardEvent=e.detail===0;handleClickBubble(source,$bubble,isKeyboardEvent);if(isKeyboardEvent){$(idCommentsAndFormHash+" textarea").first().focus()}})}};var addBubbleText=function addBubbleText(source){var bubbleText;if(testIfCommentsCountLarger0(source)){bubbleText=countComments(source)}else{bubbleText=o.defaultBubbleText}return bubbleText};var countComments=function countComments(source){var attFromSource=source.attr(attDataIncom);var selectByAtt=idCommentsAndFormHash+" ["+attDataIncomComment+'="'+attFromSource+'"]';return $(selectByAtt).length};var loadBubbleContainer=function loadBubbleContainer(source){var bubbleValue=source.attr(attDataIncom);var text='<div class="'+loadBubbleContainerClass(source)+'" '+attDataIncomBubble+'="'+bubbleValue+'" />';return text};var loadBubbleContainerClass=function loadBubbleContainerClass(source){var containerClass=classBubble;var space=" ";if(o.alwaysStatic||testIfCommentsCountLarger0(source)&&o.countStatic){containerClass+=space+classBubbleStatic}if(testIfCommentsCountLarger0(source)||!testIfCommentsCountLarger0(source)&&o.bubbleStyle==="bubble"){containerClass+=space+classBubbleStyle}else{containerClass+=space+classBubbleDynamic}return containerClass};var testIfCommentsCountLarger0=function testIfCommentsCountLarger0(source){var count=countComments(source);return isNumeric(count)&&count>0?true:false};var setDisplayStatic=function setDisplayStatic(theBubble){if(theBubble.hasClass(classBubbleStatic)){theBubble.css("display","block")}};var isNumeric=function isNumeric(value){return typeof value==="number"&&isFinite(value)||!isNaN(Number(value))};var hideBubbleTimer;var handleHover=function handleHover(element,theBubble){if(!theBubble.hasClass(classBubbleStatic)&&o.canComment){element.add(theBubble);element.on("mouseenter",function(){mouseEnterCallback(theBubble)});element.on("mouseleave",function(){mouseLeaveCallback(theBubble)});theBubble.on("mouseleave",function(){mouseLeaveCallback(theBubble)});theBubble.on("mouseenter",function(){mouseEnterCallback(theBubble)})}};var mouseEnterCallback=function mouseEnterCallback(theBubble){clearTimeout(hideBubbleTimer);$(classBubbleDot+":not("+classBubbleStaticDot+")").hide();if(o.bubbleAnimationIn==="fadein"){theBubble.stop(true,true).fadeIn()}else{theBubble.stop(true,true).show()}if(!isInWindow(bubble)){theBubble.hide()}};var mouseLeaveCallback=function mouseLeaveCallback(theBubble){hideBubbleTimer=setTimeout(function(){if($(idCommentsAndFormHash).is(":visible")){return}if(o.bubbleAnimationOut==="fadeout"){theBubble.stop(true,true).fadeOut()}else{theBubble.stop(true,true).hide()}},2e3)};var handleClickBubble=function handleClickBubble(source,theBubble){if(theBubble.hasClass(classBubbleActive)){removeCommentsWrapper(true);theBubble.removeClass(classBubbleActive)}else{removeExistingClasses(classActive);source.addClass(classActive);removeCommentsWrapper();theBubble.addClass(classBubbleActive);loadCommentsWrapper(theBubble)}};var createCommentsWrapper=function createCommentsWrapper(){var $commentsWrapper;if($(classCommentsWrapperDot).length===0){$commentsWrapper=$("<div/>",{class:classCommentsWrapper}).appendTo(idWrapperHash)}else{$commentsWrapper=$(classCommentsWrapperDot)}return $commentsWrapper};var loadCommentsWrapper=function loadCommentsWrapper(source){var $commentsWrapper=createCommentsWrapper();loadCommentForm();setCommentsWrapperPosition(source,$commentsWrapper);loadComments();testIfMoveSiteIsNecessary($commentsWrapper);handleClickElsewhere();ajaxStop()};var ajaxStop=function ajaxStop(){$(document).ready(handleClickCancel()).ajaxStop(function(){handleClickCancel()})};var loadCommentForm=function loadCommentForm(){$(idCommentsAndFormHash).appendTo(classCommentsWrapperDot).show();$(classCommentsWrapperDot).find("li.comment").show();loadHiddenInputField()};var loadHiddenInputField=function loadHiddenInputField(){var input=$("<input>").attr("type","hidden").attr("name",dataIncomKey).val(getAttDataIncomValue);$(idCommentsAndFormHash+" .incom-form-submit").append($(input))};var loadComments=function loadComments(){var flyoutComments=document.querySelectorAll(idWrapperHash+" li.comment");var fcArray=Array.from(flyoutComments);fcArray.forEach(function(comment){if(comment.getAttribute(attDataIncomComment)!==getAttDataIncomValue()){$(comment).hide()}else{$(comment).show()}});$(classVisibleCommentDot+" .children li").show();collapseAllReplies()};var collapseAllReplies=function collapseAllReplies(){var $topLevelComments=$(idCommentsAndFormHash+" > .comment");$topLevelComments.each(function(){collapseCommentReplies($(this))})};var collapseCommentReplies=function collapseCommentReplies($comment){var $repliesContainer=$comment.children(".children");if(!$repliesContainer.length){return}var replyCount=$repliesContainer.find("li").length;$comment.data("incom-reply-count",replyCount);toggleReplies($comment,"collapsed")};var toggleReplies=function toggleReplies($comment){var targetState=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var $commentChildren=$comment.find(".children");if(!$commentChildren.length){return}if(null===targetState){targetState=$comment.hasClass("incom-replies-collapsed")?"expanded":"collapsed"}var linkTextFormat;if("expanded"===targetState){linkTextFormat=__("Hide Replies (%s)","inline-comments");$comment.removeClass("incom-replies-collapsed").addClass("incom-replies-expanded")}else{linkTextFormat=__("Show Replies (%s)","inline-comments");$comment.removeClass("incom-replies-expanded").addClass("incom-replies-collapsed")}var replyCount=$comment.data("incom-reply-count");var linkText=sprintf(linkTextFormat,replyCount);$comment.find(".incom-showhide-replies button").html(linkText)};var getAttDataIncomValue=function getAttDataIncomValue(){var $attDataIncomValue=$(classActiveDot).attr(attDataIncom);return $attDataIncomValue};var setCommentsWrapperPosition=function setCommentsWrapperPosition(source,element){var $offset=source.offset();var wrapperTotalWidth=element.outerWidth()+parseInt(element.css("margin-left"))+parseInt(element.css("margin-right"));var calculateLeftOffset=function calculateLeftOffset(){var naiveLeftOffset=$offset.left+source.outerWidth();var overflow=naiveLeftOffset+wrapperTotalWidth-window.innerWidth;if(overflow>0){var bubbleLeftOffset=$offset.left;element.width(element.width()-50);return bubbleLeftOffset-element.outerWidth()}return naiveLeftOffset};var leftOffset=calculateLeftOffset();var verticalOffsetFromBubble=-48;element.css({top:$offset.top+verticalOffsetFromBubble,left:testIfPositionRight()?leftOffset:$offset.left-element.outerWidth()});if(testIfPositionRight()){if(leftOffset<source.offset().left){element.addClass("incom-has-right-bubble");source.addClass("incom-is-right-bubble")}else{element.removeClass("incom-has-right-bubble");source.removeClass("incom-is-right-bubble")}}var commentWrapperOffset=element.offset();if(commentWrapperOffset.left<0){element.width(element.width()+commentWrapperOffset.left);element.css("left",0)}};var setBubblePosition=function setBubblePosition(source,element){var $offset=source.offset();var scrollbarWidth=getScrollbarWidth();var buttonHorizontalMargin=10;var bubbleTotalWidth=element.outerWidth()+parseInt(element.css("margin-left"))+parseInt(element.css("margin-right"));var calculateScrollbarOffset=function calculateScrollbarOffset(){if(!testIfPositionRight()){return 0}var availableSpace=window.innerWidth-scrollbarWidth;var overflow=$offset.left+source.outerWidth()+bubbleTotalWidth+buttonHorizontalMargin-availableSpace;if(overflow>0){return overflow}return 0};var scrollbarOffset=calculateScrollbarOffset();var leftOffset=scrollbarOffset>0?$offset.left+source.outerWidth()-scrollbarOffset:$offset.left+source.outerWidth();element.css({top:$offset.top,left:testIfPositionRight()?leftOffset:$offset.left-element.outerWidth()});if(testIfPositionRight()){element.css("margin-right",buttonHorizontalMargin)}else{element.css("margin-left",buttonHorizontalMargin)}if(!source.data("incom-scrollbar-offset")){var sourcePaddingRight=parseInt(source.css("padding-right"));if(scrollbarOffset>0){source.css("padding-right",sourcePaddingRight+scrollbarOffset);source.data("incom-scrollbar-offset",scrollbarOffset)}}};var debug=function debug(message){var debugElement=document.getElementById("incom-debug");if(debugElement){debugElement.remove()}var newElement=document.createElement("div");newElement.id="incom-debug";var stringifyMessage=function stringifyMessage(theMessage){if(_typeof(theMessage)==="object"){return JSON.stringify(theMessage)}if(theMessage instanceof HTMLElement){return theMessage.outerHTML}return theMessage};var stringifiedMessage=stringifyMessage(message);newElement.textContent=stringifiedMessage;newElement.style.position="fixed";newElement.style.top="0";newElement.style.right="0";newElement.style.zIndex="999999999";newElement.style.padding="10px";newElement.style.wordBreak="break-all";newElement.style.backgroundColor="rgba(255, 255, 255, 0.9)";setTimeout(function(){document.body.appendChild(newElement);setTimeout(function(){newElement.remove()},8e3)},500)};var setElementProperties=function setElementProperties(element){$elementW=element.outerWidth();$offsetL=element.offset().left;$sumOffsetAndElementW=$offsetL+$elementW};var isInWindow=function isInWindow(element){setElementProperties(element);return $sumOffsetAndElementW>$viewportW||$offsetL<0?false:true};var testIfMoveSiteIsNecessary=function testIfMoveSiteIsNecessary(element){setElementProperties(element);if(testIfPositionRight()&&$sumOffsetAndElementW>$viewportW){setSlideWidth($sumOffsetAndElementW-$viewportW);moveSite("in")}else if(!testIfPositionRight()&&$offsetL<0){setSlideWidth(-$offsetL);moveSite("in")}};var setSlideWidth=function setSlideWidth(width){slideWidth=width};var getSlidewidth=function getSlidewidth(){return slideWidth};var handleClickElsewhere=function handleClickElsewhere(){var touchStartX=0;var touchStartY=0;var touchMoved=false;$("html").on("touchstart",function(e){touchStartX=e.originalEvent.touches[0].clientX;touchStartY=e.originalEvent.touches[0].clientY;touchMoved=false});$("html").on("touchmove",function(e){var touchEndX=e.originalEvent.touches[0].clientX;var touchEndY=e.originalEvent.touches[0].clientY;if(Math.abs(touchEndX-touchStartX)>10||Math.abs(touchEndY-touchStartY)>10){touchMoved=true}});$("html").on("touchend click",function(e){if(touchMoved){return}var isClickInsideWrapper=$(e.target).closest(idWrapperHash).length>0;var isClickOnReference=$(e.target).closest("["+attDataIncomRef+"]").length>0;if(!isClickInsideWrapper&&!isClickOnReference){removeCommentsWrapper(true)}})};var handleClickCancel=function handleClickCancel(){$(classCancelDot).on("click",function(e){e.preventDefault();removeCommentsWrapper(true);if(lastFocusedBubble){focusOnElement(lastFocusedBubble)}})};var removeCommentsWrapper=function removeCommentsWrapper(fadeout){var $classIncomBubble=$(classBubbleDot);var $classCommentsWrapper=$(classCommentsWrapperDot);$(idCommentsAndFormHash).appendTo(idWrapperHash).hide();$(classVisibleCommentDot).removeClass(classVisibleComment);if($classIncomBubble.hasClass(classBubbleActive)){$classIncomBubble.removeClass(classBubbleActive);if(fadeout){$classCommentsWrapper.fadeOut("fast",function(){$(this).remove();removeExistingClasses(classActive)})}else{$classCommentsWrapper.remove()}moveSite("out")}};var focusOnElement=function focusOnElement(element){element.setAttribute("tabindex","-1");element.focus();element.addEventListener("blur",function(){element.removeAttribute("tabindex")})};var moveSite=function moveSite(way){var $move=$(o.moveSiteSelector);$move.css({position:"relative"});handleWayInAndOut($move,way);if(o.moveSiteSelector!==idWrapperAppendTo){moveElement(way,classBubbleDot);moveElement(way,classCommentsWrapperDot)}};var handleWayInAndOut=function handleWayInAndOut(element,way){var value;if(way==="in"){value=getSlidewidth()}else if(way==="out"){value="initial"}moveLeftOrRight(element,value)};var moveLeftOrRight=function moveLeftOrRight(element,value){var direction=testIfPositionRight()?"right":"left";var options={};options[direction]=value;element.css(options)};var moveElement=function moveElement(way,selector){var $element=$(selector);if(way==="in"){$element.css({left:testIfPositionRight()?"-="+getSlidewidth():"+="+getSlidewidth()})}else if(way==="out"){$element.css({left:testIfPositionRight()?"+="+getSlidewidth():"-="+getSlidewidth()})}};var testIfPositionRight=function testIfPositionRight(){return o.position==="right"?true:false};var references=function references(){var source=attDataIncomRef;var target=attDataIncom;removeOutdatedReferences(source,target);loadScrollScript(source,target)};var removeOutdatedReferences=function removeOutdatedReferences(source,target){$("["+source+"]").each(function(){var $source=$(this);var targetValue=$source.attr(source);var $target=$("["+target+'="'+targetValue+'"]');if(!$target.length){$source.parent().remove()}})};var handleEvents={init:function init(){this.focusHandler();this.permalinksHandler();this.tabHandler();this.resizeHandler()},focusHandler:function focusHandler(){var commentWrapper=document.getElementById(idWrapper);if(commentWrapper){commentWrapper.addEventListener("focusin",function(e){if(e.target.classList.contains(classBubbleLink)){lastFocusedBubble=e.target}})}},permalinksHandler:function permalinksHandler(){$(idCommentsAndFormHash).on("click","a.incom-permalink",function(){var $target=$(this.hash);if($target.length){animateScrolling($target);var href=$(this).attr("href");changeUrl(href);return false}})},tabHandler:function tabHandler(){$(document).on("keydown",function(e){if(9===e.keyCode){forceShowBubbles();addSkipLink()}})},resizeHandler:function resizeHandler(){var _this=this;var lastWindowWidth=window.innerWidth;var debounce=function debounce(func,wait){var timeout;return function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}clearTimeout(timeout);timeout=setTimeout(function(){return func.apply(_this,args)},wait)}};var handleResize=function handleResize(){var currentWindowWidth=window.innerWidth;if(currentWindowWidth!==lastWindowWidth){lastWindowWidth=currentWindowWidth;incom.rebuild()}else{}};var debouncedResizeHandler=debounce(handleResize,200);window.addEventListener("resize",debouncedResizeHandler)}};var loadScrollScript=function loadScrollScript(source,target){$("["+source+"]").on("click",function(e){var targetValue=$(this).attr(source);var $target=$("["+target+'="'+targetValue+'"]');if($target.length){animateScrolling($target);removeExistingClasses(classScrolledTo);$target.addClass(classScrolledTo)}var $bubble=$('.incom-bubble[data-incom-bubble="'+targetValue+'"]');if(e.detail===0){focusOnElement($bubble[0])}if(!$bubble.hasClass(classBubbleActive)){handleClickBubble($target,$bubble)}var commentId=e.target.dataset.incomCommentId;var $commentEl=$("#incom-comment-"+commentId);var $topLevelComment=$commentEl.closest(".comments-and-form > .comment");if($topLevelComment.length){var $topLevelCommentChildren=$topLevelComment.children(".children");if($topLevelCommentChildren.length){toggleReplies($topLevelComment,"expanded")}}})};var removeExistingClasses=function removeExistingClasses(className){var $activeE=$("."+className);if($activeE.length!==0){$activeE.removeClass(className);if($activeE.prop("class").length===0){$activeE.removeAttr("class")}}};var createPluginInfo=function createPluginInfo(){var anchorElement=$(".incom-cancel-x");var element=$(loadPluginInfo());if((o.displayBranding===true||o.displayBranding===1)&&!$(classBrandingDot).length){anchorElement.after(element)}};var loadPluginInfo=function loadPluginInfo(){return'<a class="'+classBranding+'" href="http://kevinw.de/inline-comments/" title="Inline Comments by Kevin Weber" target="_blank">i</a>'};var convertHexToRgb=function convertHexToRgb(h){var r=parseInt(removeHex(h).substring(0,2),16);var g=parseInt(removeHex(h).substring(2,4),16);var b=parseInt(removeHex(h).substring(4,6),16);return r+","+g+","+b};var removeHex=function removeHex(h){return h.charAt(0)==="#"?h.substring(1,7):h};$.easing.quart=function(x,t,b,c,d){return-c*((t=t/d-1)*t*t*t-1)+b};var changeUrl=function changeUrl(href){var history=window.history||window.location;history.pushState(null,null,href);if(history.pushState){history.pushState(null,null,href)}else{history.hash=href}};var animateScrolling=function animateScrolling($target){var $scrollingRoot=$("html, body");var targetOffset=$target.offset().top-30;$scrollingRoot.animate({scrollTop:targetOffset},1200,"quart")};var forceShowBubbles=function forceShowBubbles(){document.getElementById(idWrapper).classList.add("show-bubbles");$(classBubbleDot).show()};var addSkipLink=function addSkipLink(){if(document.getElementById("incom-skip-to-comments")){return}var newSkipLink=document.createElement("a");newSkipLink.classList.add("skip-link");newSkipLink.classList.add("screen-reader-text");newSkipLink.href=idWrapperHash;newSkipLink.textContent="Skip to comments";newSkipLink.id="incom-skip-to-comments";var focusFirstBubble=function focusFirstBubble(){var firstBubble=document.querySelector(classBubbleDot);if(firstBubble){focusOnElement(firstBubble)}var contentArea=findContentArea();if(contentArea){var offset=contentArea.offset().top-100;window.scrollTo({top:offset,behavior:"smooth"})}};newSkipLink.addEventListener("keydown",function(event){if(event.key==="Enter"||event.key===" "){focusFirstBubble();event.preventDefault()}});newSkipLink.addEventListener("click",focusFirstBubble);var wpSkipLink=document.querySelector("a.skip-link");if(wpSkipLink){wpSkipLink.parentNode.insertBefore(newSkipLink,wpSkipLink.nextSibling)}else{document.body.insertBefore(newSkipLink,document.body.firstChild)}};var addIncomKeysToComments=function addIncomKeysToComments(){var commentKeys=window.incom.commentKeys;for(var commentId in commentKeys){var comment=document.getElementById("comment-".concat(commentId));if(!comment){continue}if(comment.dataset.incomComment){continue}comment.dataset.incomComment=commentKeys[commentId]}};var getScrollbarWidth=function getScrollbarWidth(){var div=document.createElement("div");div.style.position="absolute";div.style.top="-9999px";div.style.width="100px";div.style.height="100px";div.style.overflowY="scroll";document.body.appendChild(div);var scrollbarWidth=div.offsetWidth-div.clientWidth;document.body.removeChild(div);return scrollbarWidth};var markCurrentCommentBeingRepliedTo=function markCurrentCommentBeingRepliedTo($comment){$(".comment").removeClass("incom-replying-to");$(".children").removeClass("incom-replying-to-children");$comment.addClass("incom-replying-to");$comment.closest(".children").addClass("incom-replying-to-children");var commentId=$comment.attr("id").replace("incom-comment-","");$("#incom-comment_parent").val(commentId);var $topLevelComment=$comment.closest(".comments-and-form > .comment");if($topLevelComment.length){toggleReplies($topLevelComment,"expanded")}};var moveCommentFormToComment=function moveCommentFormToComment($repliedToComment){var $commentFormDiv=$("#incom-respond");$commentFormDiv.find(".submit").val(__("Post reply","inline-comments"));$commentFormDiv.appendTo($repliedToComment)};var addCancelLinkToReplyForm=function addCancelLinkToReplyForm(){var $commentForm=$("#incom-respond");if(!$commentForm.length){return}var $cancelLink=$('<a class="incom-cancel-reply-link" href="#">'+__("Cancel","inline-comments")+"</a>");$cancelLink.on("click",function(event){event.preventDefault();$commentForm.find(".submit").val(__("Post comment","inline-comments"));$commentForm.appendTo(idCommentsAndFormHash)});$(".incom-form-submit").append($cancelLink)};incom.init=function(options){setOptions(options);addIncomKeysToComments();initIncomWrapper();createPluginInfo();references();addCancelLinkToReplyForm();$(classReplyDot+" .incom-reply-link").off("click").on("click",function(event){event.preventDefault();$(idCommentsAndFormHash+" #commentform").attr("id",idCommentForm);var $repliedToComment=$(event.target.closest(".comment"));markCurrentCommentBeingRepliedTo($repliedToComment);moveCommentFormToComment($repliedToComment)});handleEvents.init();if("ontouchstart"in window){forceShowBubbles()}$(idCommentsAndFormHash).on("click",".incom-showhide-replies button",function(event){event.preventDefault();var $comment=$(this).closest(".comment");toggleReplies($comment)});$("#incom-comment").attr("placeholder",__("Enter comment","inline-comments"))}})(window.incom=window.incom||{},jQuery);